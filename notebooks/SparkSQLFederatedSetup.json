{"paragraphs":[{"text":"%md\n# SparkSQL Data Federation Demo\nDemonstrate how SparkSQL can act as a distributed data federation platform.\nTables are created from three different sources:\n- Data that being processed by Spark \n- Data in Hive \n- Data in Postgres\n\nSpark makes all of these tables available via JDBC as if from as single data store","dateUpdated":"May 4, 2016 12:00:00 AM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000938_2044592067","id":"20160504-000000_1321679444","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>SparkSQL Data Federation Demo</h1>\n<p>Demonstrate how SparkSQL can act as a distributed data federation platform.\n<br  />Tables are created from three different sources:</p>\n<ul>\n<li>Data that being processed by Spark</li>\n<li>Data in Hive</li>\n<li>Data in Postgres</li>\n</ul>\n<p>Spark makes all of these tables available via JDBC as if from as single data store</p>\n"},"dateCreated":"May 4, 2016 12:00:00 AM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2107"},{"text":"%md\nZeppelin must be able to sudo and access Postgres.\nRun the following commands as root at the host console:\n\n`echo \"zeppelin  ALL=(ALL) NOPASSWD: ALL\" >> /etc/sudoers`\n`echo \"host all all 127.0.0.1/32 md5\" >> /var/lib/pgsql/data/pg_hba.conf`","dateUpdated":"May 4, 2016 12:00:00 AM","config":{"enabled":true,"title":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000952_2049978552","id":"20160504-000000_248472297","result":{"code":"SUCCESS","type":"HTML","msg":"<p>Zeppelin must be able to sudo and access Postgres.\n<br  />Run the following commands as root at the host console:</p>\n<p><code>echo \"zeppelin  ALL=(ALL) NOPASSWD: ALL\" &gt;&gt; /etc/sudoers</code>\n<br  /><code>echo \"host all all 127.0.0.1/32 md5\" &gt;&gt; /var/lib/pgsql/data/pg_hba.conf</code></p>\n"},"dateCreated":"May 4, 2016 12:00:00 AM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2108"},{"title":"Load Dependencies","text":"%dep\nz.load(\"com.databricks:spark-csv_2.10:1.4.0\")\nz.load(\"mysql:mysql-connector-java:5.1.38\")\nz.load(\"org.postgresql:postgresql:9.4-1201-jdbc41\")\n//z.load(\"/tmp/mysql-connector-java-5.1.38-bin.jar\")","dateUpdated":"May 4, 2016 12:00:00 AM","config":{"enabled":true,"title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000952_2049978552","id":"20160504-000000_1365685911","result":{"code":"SUCCESS","type":"TEXT","msg":"res0: org.apache.zeppelin.dep.Dependency = org.apache.zeppelin.dep.Dependency@2379461d\n"},"dateCreated":"May 4, 2016 12:00:00 AM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2109"},{"title":"Restart Ambari and Postgres","text":"%sh\n# on sandbox, use 'service ambari stop/start'\n# on cluster, use 'service ambari-server stop/start'\ncount=$(chkconfig --list | grep ambari | wc -l)\nif [ $count -eq 3 ]\nthen\n    ambari_svc=\"ambari\" \nelse\n    ambari_svc=\"ambari-server\"\nfi\n\nsudo service $ambari_svc stop\nsudo service postgresql stop\nsudo service postgresql start\nsudo service $ambari_svc start","dateUpdated":"May 4, 2016 12:00:14 AM","config":{"enabled":true,"title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000953_2049593803","id":"20160504-000000_777887041","result":{"code":"SUCCESS","type":"TEXT","msg":"Stopping Ganglia\n/etc/init.d/ambari: line 30: /etc/init.d/hdp-gmetad: No such file or directory\n/etc/init.d/ambari: line 31: /etc/init.d/hdp-gmond: No such file or directory\nStopping Nagios\n/etc/init.d/ambari: line 34: /etc/init.d/nagios: No such file or directory\nStopping Ambari server\nUsing python  /usr/bin/python2\nStopping ambari-server\nAmbari Server stopped\nStopping Ambari agent\nVerifying Python version compatibility...\nUsing python  /usr/bin/python2\nFound ambari-agent PID: 3062\nStopping ambari-agent\nRemoving PID file at /var/run/ambari-agent/ambari-agent.pid\n\u001b[1mambari-agent successfully stopped\n\u001b[0;10mStopping postgresql service: [  OK  ]\r\nStarting postgresql service: [  OK  ]\r\nStarting Ambari...                                \nStarting Ambari server                                    [\u001b[32;01m  OK  \u001b[0m]\nStarting Ambari agent                                     [\u001b[32;01m  OK  \u001b[0m]\n"},"dateCreated":"May 4, 2016 12:00:00 AM","dateStarted":"May 4, 2016 12:00:14 AM","dateFinished":"May 4, 2016 12:00:58 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2110"},{"title":"Create DimStore Table in Postgres","text":"%sh\nexport PGPASSWORD=zeppelin\n#Create Contoso database\nsudo -u postgres psql -c \"create database contoso;\"\nsudo -u postgres psql -c \"CREATE USER zeppelin WITH PASSWORD 'zeppelin';\"\nsudo -u postgres psql -c \"GRANT ALL PRIVILEGES ON DATABASE contoso to zeppelin;\"\nsudo -u postgres psql -c \"\\du\"\n\n#Run sql to create tables and import data from csv\npsql -U zeppelin -d contoso -h localhost -c \"\nCREATE TABLE DimStore (\nStoreKey int,\nGeographyKey int,\nStoreManager int,\nStoreType varchar,\nStoreName varchar,\nStoreDescription varchar,\nStatus varchar,\nOpenDate timestamp ,  \nCloseDate timestamp ,  \nEntityKey int,\nZipCode varchar,\nZipCodeExtension varchar,\nStorePhone varchar,\nStoreFax varchar,\nCloseReason varchar,\nEmployeeCount int,\nSellingAreaSize float,\nLastRemodelDate timestamp ,  \nETLLoadID int,\nSomeDate1 timestamp , \nSomeDate2 timestamp , \nLoadDate timestamp , \nUpdateDate timestamp \n );\"\n \npsql -U zeppelin -d contoso -h localhost -c \"\\copy DimStore FROM '/tmp/data/DimStore.csv' DELIMITER ',' CSV HEADER\" \npsql -U zeppelin -d contoso -h localhost -c \"select * from DimStore limit 5;\" \n\n#list tables\npsql -U zeppelin -d contoso -h localhost -c \"\\dt\"","dateUpdated":"May 4, 2016 12:02:07 AM","config":{"enabled":true,"title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/sh","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000953_2049593803","id":"20160504-000000_67055151","result":{"code":"SUCCESS","type":"TEXT","msg":"CREATE DATABASE\nCREATE ROLE\nGRANT\n            List of roles\n Role name | Attributes  | Member of \n-----------+-------------+-----------\n ambari    |             | {}\n mapred    |             | {}\n postgres  | Superuser   | {}\n           : Create role   \n           : Create DB     \n zeppelin  |             | {}\n\nCREATE TABLE\n storekey | geographykey | storemanager | storetype |         storename          |      storedescription      | status |      opendate       | closedate | entitykey | zipcode | zipcodeextension |  storephone  |   storefax   | closereason | employeecount | sellingareasize |   lastremodeldate   | etlloadid |      somedate1      |      somedate2      |      loaddate       |     updatedate      \n----------+--------------+--------------+-----------+----------------------------+----------------------------+--------+---------------------+-----------+-----------+---------+------------------+--------------+--------------+-------------+---------------+-----------------+---------------------+-----------+---------------------+---------------------+---------------------+---------------------\n        1 |          693 |           35 | Store     | Contoso Seattle No.1 Store | Contoso Seattle No.1 Store | On     | 2004-04-12 00:00:00 |           |       635 | 97001   | 97001            | 320-555-0195 | 320-555-0195 |             |            17 |             462 | 2009-06-16 00:00:00 |         1 | 2009-06-05 00:00:00 | 2009-06-05 00:00:00 | 2009-06-05 00:00:00 | 2009-06-05 00:00:00\n        2 |          693 |           35 | Store     | Contoso Seattle No.2 Store | Contoso Seattle No.2 Store | On     | 2004-02-14 00:00:00 |           |       636 | 97001   | 97002            | 150-555-0189 | 150-555-0189 |             |            25 |             700 | 2009-06-17 00:00:00 |         1 | 2009-06-05 00:00:00 | 2009-06-05 00:00:00 | 2009-06-05 00:00:00 | 2009-06-05 00:00:00\n        3 |          856 |           36 | Store     | Contoso Kennewick Store    | Contoso Kennewick Store    | On     | 2004-02-12 00:00:00 |           |       934 | 97001   | 97003            | 212-555-0187 | 212-555-0187 |             |            26 |             680 | 2009-06-18 00:00:00 |         1 | 2008-11-21 00:00:00 | 2008-11-21 00:00:00 | 2008-11-21 00:00:00 | 2008-11-21 00:00:00\n        4 |          424 |           37 | Store     | Contoso Bellevue Store     | Contoso Bellevue Store     | On     | 2004-03-01 00:00:00 |           |       638 | 97001   | 97004            | 612-555-0100 | 612-555-0100 |             |            19 |             455 | 2009-06-16 00:00:00 |         1 | 2009-07-01 00:00:00 | 2009-07-01 00:00:00 | 2009-07-01 00:00:00 | 2009-07-01 00:00:00\n        5 |          677 |           38 | Store     | Contoso Redmond Store      | Contoso Redmond Store      | On     | 2004-04-02 00:00:00 |           |       639 | 97001   | 97005            | 612-555-0100 | 612-555-0100 |             |            33 |             560 | 2009-06-17 00:00:00 |         1 | 2009-06-13 00:00:00 | 2009-06-13 00:00:00 | 2009-06-13 00:00:00 | 2009-06-13 00:00:00\n(5 rows)\n\n          List of relations\n Schema |   Name   | Type  |  Owner   \n--------+----------+-------+----------\n public | dimstore | table | zeppelin\n(1 row)\n\n"},"dateCreated":"May 4, 2016 12:00:00 AM","dateStarted":"May 4, 2016 12:02:07 AM","dateFinished":"May 4, 2016 12:02:23 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2111"},{"title":"Download Data","text":"%sh\ncd /tmp\nwget -q https://www.dropbox.com/s/r70i8j1ujx4h7j8/data.zip\nunzip data.zip\nhead /tmp/data/FactSales.csv","dateUpdated":"May 4, 2016 12:00:00 AM","config":{"enabled":true,"title":true,"tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000954_2050748049","id":"20160504-000000_1714491829","result":{"code":"SUCCESS","type":"TEXT","msg":"Archive:  data.zip\n  inflating: data/DimAccount.csv     \n  inflating: data/DimChannel.csv     \n  inflating: data/DimCurrency.csv    \n  inflating: data/DimCustomer.csv    \n  inflating: data/DimDate.csv        \n  inflating: data/DimEmployee.csv    \n  inflating: data/DimEntity.csv      \n  inflating: data/DimGeography.csv   \n  inflating: data/DimMachine.csv     \n  inflating: data/DimOutage.csv      \n  inflating: data/DimProduct.csv     \n  inflating: data/DimProductCategory.csv  \n  inflating: data/DimProductSubcategory.csv  \n  inflating: data/DimPromotion.csv   \n  inflating: data/DimSalesTerritory.csv  \n  inflating: data/DimScenario.csv    \n  inflating: data/DimStore.csv       \n  inflating: data/FactExchangeRate.csv  \n  inflating: data/FactInventory.csv  \n  inflating: data/FactITMachine.csv  \n  inflating: data/FactITSLA.csv      \n  inflating: data/FactOnlineSales.csv  \n  inflating: data/FactSales.csv      \n  inflating: data/FactSalesQuota.csv  \n  inflating: data/FactStrategyPlan.csv  \nSalesKey,DateKey,channelKey,StoreKey,ProductKey,PromotionKey,CurrencyKey,UnitCost,UnitPrice,SalesQuantity,ReturnQuantity,ReturnAmount,DiscountQuantity,DiscountAmount,TotalCost,SalesAmount,ETLLoadID,LoadDate,UpdateDate\r\n1,2007-01-02 00:00:00,1,209,956,10,1,91.05,198,8,0,0,1,39.6,728.4,1544.4,1,2010-01-01 00:00:00,2010-01-01 00:00:00\r\n2,2007-02-12 00:00:00,4,308,766,2,1,10.15,19.9,4,0,0,1,0.995,40.6,78.605,1,2010-01-01 00:00:00,2010-01-01 00:00:00\r\n3,2008-01-24 00:00:00,1,156,1175,11,1,209.03,410,9,0,0,3,61.5,1881.27,3628.5,1,2010-01-01 00:00:00,2010-01-01 00:00:00\r\n4,2008-01-13 00:00:00,2,306,1429,10,1,132.9,289,8,0,0,1,57.8,1063.2,2254.2,1,2010-01-01 00:00:00,2010-01-01 00:00:00\r\n5,2008-01-22 00:00:00,2,306,1133,10,1,144.52,436.2,24,0,0,3,261.72,3468.48,10207.08,1,2010-01-01 00:00:00,2010-01-01 00:00:00\r\n6,2007-07-02 00:00:00,3,200,2365,3,1,183.94,399.99,36,0,0,10,399.99,6621.84,13999.65,1,2010-01-01 00:00:00,2010-01-01 00:00:00\r\n7,2007-11-19 00:00:00,4,310,1016,5,1,68.06,148,6,0,0,2,44.4,408.36,843.6,1,2010-01-01 00:00:00,2010-01-01 00:00:00\r\n8,2008-04-10 00:00:00,2,307,138,15,1,229.93,499.99,9,0,0,1,99.998,2069.37,4399.912,1,2010-01-01 00:00:00,2010-01-01 00:00:00\r\n9,2008-07-14 00:00:00,2,199,1731,12,1,33.32,72.45,24,0,0,5,36.225,799.68,1702.575,1,2010-01-01 00:00:00,2010-01-01 00:00:00\r\n"},"dateCreated":"May 4, 2016 12:00:00 AM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2112"},{"title":"Move Data to HDFS","text":"%sh\n#head -1000000 /tmp/data/FactInventory.csv > /tmp/data/FactInventoryTemp.csv\n#head -1000000 /tmp/data/FactSales.csv > /tmp/data/FactSalesTemp.csv\n#head -1000000 /tmp/data/FactOnlineSales.csv > /tmp/data/FactOnlineSalesTemp.csv\n\nsudo -u hdfs hadoop fs -mkdir /tmp/DimCustomer\nsudo -u hdfs hadoop fs -mkdir /tmp/DimProduct\nsudo -u hdfs hadoop fs -mkdir /tmp/FactSales\nsudo -u hdfs hadoop fs -mkdir /tmp/FactOnlineSales\nsudo -u hdfs hadoop fs -put /tmp/data/DimCustomer.csv /tmp/DimCustomer/DimCustomer.csv\nsudo -u hdfs hadoop fs -put /tmp/data/DimProduct.csv /tmp/DimProduct/DimProduct.csv\nsudo -u hdfs hadoop fs -put /tmp/data/FactSales.csv /tmp/FactSales/FactSales.csv\nsudo -u hdfs hadoop fs -put /tmp/data/FactOnlineSales.csv /tmp/FactOnlineSales/FactOnlineSales.csv\nsudo -u hdfs hadoop fs -chown -R zeppelin:hdfs /tmp/DimCustomer/\nsudo -u hdfs hadoop fs -chown -R zeppelin:hdfs /tmp/DimProduct/\nsudo -u hdfs hadoop fs -chown -R zeppelin:hdfs /tmp/FactSales\nsudo -u hdfs hadoop fs -chown -R zeppelin:hdfs /tmp/FactOnlineSales","dateUpdated":"May 4, 2016 12:12:57 AM","config":{"enabled":true,"title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/sh","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000954_2050748049","id":"20160504-000000_528594557","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"May 4, 2016 12:00:00 AM","dateStarted":"May 4, 2016 12:12:57 AM","dateFinished":"May 4, 2016 12:16:13 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2113"},{"title":"Create Hive Tables","text":"","dateUpdated":"May 4, 2016 12:00:00 AM","config":{"enabled":true,"title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000959_2048824305","id":"20160504-000000_2096355507","dateCreated":"May 4, 2016 12:00:00 AM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2114"},{"text":"%hive\nCREATE EXTERNAL TABLE IF NOT EXISTS `FactSalesTemp`(\n`SalesKey` int,\n`DateKey` timestamp,  \n`channelKey` int,  \n`StoreKey` int,\n`ProductKey` int,\n`PromotionKey` int,\n`CurrencyKey` int,\n`UnitCost` float,\n`UnitPrice` float,\n`SalesQuantity` int, \n`ReturnQuantity` int,\n`ReturnAmount` float,\n`DiscountQuantity` int,\n`DiscountAmount` float,\n`TotalCost` float,\n`SalesAmount` float,\n`ETLLoadID` int,\n`LoadDate` timestamp , \n`UpdateDate` timestamp)\nROW FORMAT\nDELIMITED FIELDS TERMINATED BY ','\nLOCATION '/tmp/FactSales/'\ntblproperties (\"skip.header.line.count\"=\"1\")","dateUpdated":"May 4, 2016 12:17:28 AM","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Update Count","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"Update Count","index":0,"aggr":"sum"}}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000960_2034588596","id":"20160504-000000_1830293467","result":{"code":"ERROR","type":"TEXT","msg":"Error while processing statement: FAILED: Hive Internal Error: org.apache.atlas.AtlasServiceException(Metadata service API CREATE_ENTITY failed with status 500(Internal Server Error) Response Body ({\"error\":\"Could not process individual retrieval call \",\"stackTrace\":\"com.thinkaurelius.titan.core.TitanException: Could not process individual retrieval call \\n\\tat com.thinkaurelius.titan.graphdb.query.QueryUtil.processIntersectingRetrievals(QueryUtil.java:234)\\n\\tat com.thinkaurelius.titan.graphdb.transaction.StandardTitanTx$8.execute(StandardTitanTx.java:1234)\\n\\tat com.thinkaurelius.titan.graphdb.transaction.StandardTitanTx$8.execute(StandardTitanTx.java:1103)\\n\\tat com.thinkaurelius.titan.graphdb.query.MetricsQueryExecutor$4.apply(MetricsQueryExecutor.java:66)\\n\\tat com.thinkaurelius.titan.graphdb.query.MetricsQueryExecutor$4.apply(MetricsQueryExecutor.java:63)\\n\\tat com.thinkaurelius.titan.graphdb.query.MetricsQueryExecutor.runWithMetrics(MetricsQueryExecutor.java:81)\\n\\tat com.thinkaurelius.titan.graphdb.query.MetricsQueryExecutor.execute(MetricsQueryExecutor.java:63)\\n\\tat com.thinkaurelius.titan.graphdb.query.QueryProcessor$LimitAdjustingIterator.getNewIterator(QueryProcessor.java:195)\\n\\tat com.thinkaurelius.titan.graphdb.query.LimitAdjustingIterator.hasNext(LimitAdjustingIterator.java:54)\\n\\tat com.thinkaurelius.titan.graphdb.query.ResultSetIterator.nextInternal(ResultSetIterator.java:40)\\n\\tat com.thinkaurelius.titan.graphdb.query.ResultSetIterator.<init>(ResultSetIterator.java:30)\\n\\tat com.thinkaurelius.titan.graphdb.query.QueryProcessor.iterator(QueryProcessor.java:56)\\n\\tat com.google.common.collect.Iterables$7.iterator(Iterables.java:613)\\n\\tat com.google.common.collect.Iterables.getOnlyElement(Iterables.java:284)\\n\\tat com.thinkaurelius.titan.graphdb.database.StandardTitanGraph$1.retrieveSchemaByName(StandardTitanGraph.java:302)\\n\\tat com.thinkaurelius.titan.graphdb.database.cache.StandardSchemaCache.getSchemaId(StandardSchemaCache.java:98)\\n\\tat com.thinkaurelius.titan.graphdb.transaction.StandardTitanTx.getSchemaVertex(StandardTitanTx.java:844)\\n\\tat com.thinkaurelius.titan.graphdb.transaction.StandardTitanTx.getRelationType(StandardTitanTx.java:864)\\n\\tat com.thinkaurelius.titan.graphdb.transaction.StandardTitanTx.containsRelationType(StandardTitanTx.java:854)\\n\\tat com.thinkaurelius.titan.graphdb.vertices.AbstractVertex.getProperty(AbstractVertex.java:151)\\n\\tat org.apache.atlas.repository.graph.GraphBackedMetadataRepository$GraphToTypedInstanceMapper.mapVertexToMapInstance(GraphBackedMetadataRepository.java:1048)\\n\\tat org.apache.atlas.repository.graph.GraphBackedMetadataRepository$GraphToTypedInstanceMapper.mapVertexToAttribute(GraphBackedMetadataRepository.java:938)\\n\\tat org.apache.atlas.repository.graph.GraphBackedMetadataRepository$GraphToTypedInstanceMapper.mapVertexToInstance(GraphBackedMetadataRepository.java:907)\\n\\tat org.apache.atlas.repository.graph.GraphBackedMetadataRepository$GraphToTypedInstanceMapper.mapGraphToTypedInstance(GraphBackedMetadataRepository.java:886)\\n\\tat org.apache.atlas.repository.graph.GraphBackedMetadataRepository.getEntityDefinition(GraphBackedMetadataRepository.java:166)\\n\\tat org.apache.atlas.GraphTransactionInterceptor.invoke(GraphTransactionInterceptor.java:41)\\n\\tat org.apache.atlas.services.DefaultMetadataService.getEntityDefinition(DefaultMetadataService.java:265)\\n\\tat org.apache.atlas.web.resources.EntityResource.submit(EntityResource.java:104)\\n\\tat sun.reflect.GeneratedMethodAccessor38.invoke(Unknown Source)\\n\\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\n\\tat java.lang.reflect.Method.invoke(Method.java:606)\\n\\tat com.sun.jersey.spi.container.JavaMethodInvokerFactory$1.invoke(JavaMethodInvokerFactory.java:60)\\n\\tat com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$ResponseOutInvoker._dispatch(AbstractResourceMethodDispatchProvider.java:205)\\n\\tat com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:75)\\n\\tat com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:288)\\n\\tat com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:108)\\n\\tat com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)\\n\\tat com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:84)\\n\\tat com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1469)\\n\\tat com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1400)\\n\\tat com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1349)\\n\\tat com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1339)\\n\\tat com.sun.jersey.spi.container.servlet.WebComponent.service(WebComponent.java:409)\\n\\tat com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:558)\\n\\tat com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:733)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:790)\\n\\tat com.google.inject.servlet.ServletDefinition.doServiceImpl(ServletDefinition.java:287)\\n\\tat com.google.inject.servlet.ServletDefinition.doService(ServletDefinition.java:277)\\n\\tat com.google.inject.servlet.ServletDefinition.service(ServletDefinition.java:182)\\n\\tat com.google.inject.servlet.ManagedServletPipeline.service(ManagedServletPipeline.java:91)\\n\\tat com.google.inject.servlet.FilterChainInvocation.doFilter(FilterChainInvocation.java:85)\\n\\tat org.apache.atlas.web.filters.AuditFilter.doFilter(AuditFilter.java:67)\\n\\tat com.google.inject.servlet.FilterChainInvocation.doFilter(FilterChainInvocation.java:82)\\n\\tat com.google.inject.servlet.ManagedFilterPipeline.dispatch(ManagedFilterPipeline.java:119)\\n\\tat com.google.inject.servlet.GuiceFilter$1.call(GuiceFilter.java:133)\\n\\tat com.google.inject.servlet.GuiceFilter$1.call(GuiceFilter.java:130)\\n\\tat com.google.inject.servlet.GuiceFilter$Context.call(GuiceFilter.java:203)\\n\\tat com.google.inject.servlet.GuiceFilter.doFilter(GuiceFilter.java:130)\\n\\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)\\n\\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:585)\\n\\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)\\n\\tat org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:577)\\n\\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:223)\\n\\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1127)\\n\\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:515)\\n\\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)\\n\\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1061)\\n\\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\\n\\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)\\n\\tat org.eclipse.jetty.server.Server.handle(Server.java:499)\\n\\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:310)\\n\\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:257)\\n\\tat org.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:540)\\n\\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)\\n\\tat org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)\\n\\tat java.lang.Thread.run(Thread.java:745)\\nCaused by: com.thinkaurelius.titan.core.TitanException: Could not call index\\n\\tat com.thinkaurelius.titan.graphdb.transaction.StandardTitanTx$8$6.call(StandardTitanTx.java:1227)\\n\\tat com.thinkaurelius.titan.graphdb.query.QueryUtil.processIntersectingRetrievals(QueryUtil.java:232)\\n\\t... 75 more\\nCaused by: com.thinkaurelius.titan.core.TitanException: Could not execute operation due to backend exception\\n\\tat com.thinkaurelius.titan.diskstorage.util.BackendOperation.execute(BackendOperation.java:44)\\n\\tat com.thinkaurelius.titan.diskstorage.BackendTransaction.executeRead(BackendTransaction.java:428)\\n\\tat com.thinkaurelius.titan.diskstorage.BackendTransaction.indexQuery(BackendTransaction.java:380)\\n\\tat com.thinkaurelius.titan.graphdb.query.graph.MultiKeySliceQuery.execute(MultiKeySliceQuery.java:37)\\n\\tat com.thinkaurelius.titan.graphdb.database.IndexSerializer.query(IndexSerializer.java:510)\\n\\tat com.thinkaurelius.titan.graphdb.transaction.StandardTitanTx$8$6$1.call(StandardTitanTx.java:1223)\\n\\tat com.thinkaurelius.titan.graphdb.transaction.StandardTitanTx$8$6$1.call(StandardTitanTx.java:1220)\\n\\tat com.google.common.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:4792)\\n\\tat com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3599)\\n\\tat com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2379)\\n\\tat com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2342)\\n\\tat com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2257)\\n\\tat com.google.common.cache.LocalCache.get(LocalCache.java:4000)\\n\\tat com.google.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:4789)\\n\\tat com.thinkaurelius.titan.graphdb.transaction.StandardTitanTx$8$6.call(StandardTitanTx.java:1220)\\n\\t... 76 more\\nCaused by: com.thinkaurelius.titan.diskstorage.PermanentBackendException: Permanent failure in storage backend\\n\\tat com.thinkaurelius.titan.diskstorage.berkeleyje.BerkeleyJEKeyValueStore.getSlice(BerkeleyJEKeyValueStore.java:166)\\n\\tat com.thinkaurelius.titan.diskstorage.keycolumnvalue.keyvalue.OrderedKeyValueStoreAdapter.getSlice(OrderedKeyValueStoreAdapter.java:56)\\n\\tat com.thinkaurelius.titan.diskstorage.keycolumnvalue.cache.KCVSCache.getSliceNoCache(KCVSCache.java:63)\\n\\tat com.thinkaurelius.titan.diskstorage.BackendTransaction$5.call(BackendTransaction.java:383)\\n\\tat com.thinkaurelius.titan.diskstorage.BackendTransaction$5.call(BackendTransaction.java:380)\\n\\tat com.thinkaurelius.titan.diskstorage.util.BackendOperation.executeDirect(BackendOperation.java:56)\\n\\tat com.thinkaurelius.titan.diskstorage.util.BackendOperation.execute(BackendOperation.java:42)\\n\\t... 90 more\\nCaused by: com.sleepycat.je.LockTimeoutException: (JE 5.0.73) Lock expired. Locker 277231471 13389_qtp1811636174-66 - f3a2d43a-1f6a-4130-831f-8c34ffc38f32_Txn: waited for lock on database=graphindex LockAddr:1223495868 LSN=0x0\\/0xaedb1 type=READ grant=WAIT_NEW timeoutMillis=500 startTime=1462321125585 endTime=1462321126117\\nOwners: [<LockInfo locker=\\\"715513176 13335_qtp1811636174-64 - 83550e2c-8a15-480b-95dd-8d3dfd65806e_Txn\\\" type=\\\"WRITE\\\"\\/>]\\nWaiters: [<LockInfo locker=\\\"752333817 13390_qtp1811636174-68 - 1ad3d626-2759-458f-ac10-69ae123a296a_Txn\\\" type=\\\"READ\\\"\\/>]\\n\\n\\tat com.sleepycat.je.txn.LockManager.newLockTimeoutException(LockManager.java:664)\\n\\tat com.sleepycat.je.txn.LockManager.makeTimeoutMsgInternal(LockManager.java:623)\\n\\tat com.sleepycat.je.txn.SyncedLockManager.makeTimeoutMsg(SyncedLockManager.java:97)\\n\\tat com.sleepycat.je.txn.LockManager.lockInternal(LockManager.java:390)\\n\\tat com.sleepycat.je.txn.LockManager.lock(LockManager.java:276)\\n\\tat com.sleepycat.je.txn.Txn.lockInternal(Txn.java:498)\\n\\tat com.sleepycat.je.txn.Locker.lock(Locker.java:443)\\n\\tat com.sleepycat.je.dbi.CursorImpl.lockLN(CursorImpl.java:2621)\\n\\tat com.sleepycat.je.dbi.CursorImpl.lockLN(CursorImpl.java:2422)\\n\\tat com.sleepycat.je.dbi.CursorImpl.fetchCurrent(CursorImpl.java:2253)\\n\\tat com.sleepycat.je.dbi.CursorImpl.getCurrentAlreadyLatched(CursorImpl.java:1466)\\n\\tat com.sleepycat.je.dbi.CursorImpl.getNext(CursorImpl.java:1593)\\n\\tat com.sleepycat.je.Cursor.searchInternal(Cursor.java:2742)\\n\\tat com.sleepycat.je.Cursor.searchAllowPhantoms(Cursor.java:2576)\\n\\tat com.sleepycat.je.Cursor.searchNoDups(Cursor.java:2430)\\n\\tat com.sleepycat.je.Cursor.search(Cursor.java:2397)\\n\\tat com.sleepycat.je.Cursor.getSearchKeyRange(Cursor.java:1727)\\n\\tat com.thinkaurelius.titan.diskstorage.berkeleyje.BerkeleyJEKeyValueStore.getSlice(BerkeleyJEKeyValueStore.java:123)\\n\\t... 96 more\\n\"}))"},"dateCreated":"May 4, 2016 12:00:00 AM","dateStarted":"May 4, 2016 12:17:28 AM","dateFinished":"May 4, 2016 12:18:46 AM","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:2115"},{"text":"%hive\nCREATE EXTERNAL TABLE IF NOT EXISTS `FactOnlineSalesTemp`(\n`OnlineSalesKey` int,\n`DateKey` timestamp,\n`StoreKey` int,  \n`ProductKey` int,\n`PromotionKey` int,\n`CurrencyKey` int,\n`CustomerKey` int,\n`SalesOrderNumber` string,\n`SalesOrderLineNumber` int,\n`SalesQuantity` int , \n`SalesAmount` float,\n`ReturnQuantity` int,\n`ReturnAmount` float,\n`DiscountQuantity` int,\n`DiscountAmount` float,\n`TotalCost` float,\n`UnitCost` float,\n`UnitPrice` float,\n`ETLLoadID` int,\n`LoadDate` timestamp, \n`UpdateDate` timestamp) \nROW FORMAT\nDELIMITED FIELDS TERMINATED BY ',' \nLOCATION '/tmp/FactOnlineSales/' \ntblproperties (\"skip.header.line.count\"=\"1\")\n","dateUpdated":"May 4, 2016 12:17:34 AM","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Update Count","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"Update Count","index":0,"aggr":"sum"}}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000960_2034588596","id":"20160504-000000_1186540241","result":{"code":"ERROR","type":"TEXT","msg":"Error while processing statement: FAILED: Hive Internal Error: org.apache.atlas.AtlasServiceException(Metadata service API CREATE_ENTITY failed with status 400(Bad Request) Response Body ({\"error\":\"org.apache.atlas.typesystem.types.ValueConversionException$NullConversionException: Null value not allowed for multiplicty Multiplicity{lower=1, upper=1, isUnique=false}\",\"stackTrace\":\"org.apache.atlas.repository.RepositoryException: org.apache.atlas.typesystem.types.ValueConversionException$NullConversionException: Null value not allowed for multiplicty Multiplicity{lower=1, upper=1, isUnique=false}\\n\\tat org.apache.atlas.repository.graph.GraphBackedMetadataRepository.getEntityDefinition(GraphBackedMetadataRepository.java:169)\\n\\tat org.apache.atlas.GraphTransactionInterceptor.invoke(GraphTransactionInterceptor.java:41)\\n\\tat org.apache.atlas.services.DefaultMetadataService.getEntityDefinition(DefaultMetadataService.java:265)\\n\\tat org.apache.atlas.web.resources.EntityResource.submit(EntityResource.java:104)\\n\\tat sun.reflect.GeneratedMethodAccessor38.invoke(Unknown Source)\\n\\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\n\\tat java.lang.reflect.Method.invoke(Method.java:606)\\n\\tat com.sun.jersey.spi.container.JavaMethodInvokerFactory$1.invoke(JavaMethodInvokerFactory.java:60)\\n\\tat com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$ResponseOutInvoker._dispatch(AbstractResourceMethodDispatchProvider.java:205)\\n\\tat com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:75)\\n\\tat com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:288)\\n\\tat com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:108)\\n\\tat com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)\\n\\tat com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:84)\\n\\tat com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1469)\\n\\tat com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1400)\\n\\tat com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1349)\\n\\tat com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1339)\\n\\tat com.sun.jersey.spi.container.servlet.WebComponent.service(WebComponent.java:409)\\n\\tat com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:558)\\n\\tat com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:733)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:790)\\n\\tat com.google.inject.servlet.ServletDefinition.doServiceImpl(ServletDefinition.java:287)\\n\\tat com.google.inject.servlet.ServletDefinition.doService(ServletDefinition.java:277)\\n\\tat com.google.inject.servlet.ServletDefinition.service(ServletDefinition.java:182)\\n\\tat com.google.inject.servlet.ManagedServletPipeline.service(ManagedServletPipeline.java:91)\\n\\tat com.google.inject.servlet.FilterChainInvocation.doFilter(FilterChainInvocation.java:85)\\n\\tat org.apache.atlas.web.filters.AuditFilter.doFilter(AuditFilter.java:67)\\n\\tat com.google.inject.servlet.FilterChainInvocation.doFilter(FilterChainInvocation.java:82)\\n\\tat com.google.inject.servlet.ManagedFilterPipeline.dispatch(ManagedFilterPipeline.java:119)\\n\\tat com.google.inject.servlet.GuiceFilter$1.call(GuiceFilter.java:133)\\n\\tat com.google.inject.servlet.GuiceFilter$1.call(GuiceFilter.java:130)\\n\\tat com.google.inject.servlet.GuiceFilter$Context.call(GuiceFilter.java:203)\\n\\tat com.google.inject.servlet.GuiceFilter.doFilter(GuiceFilter.java:130)\\n\\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)\\n\\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:585)\\n\\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)\\n\\tat org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:577)\\n\\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:223)\\n\\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1127)\\n\\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:515)\\n\\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)\\n\\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1061)\\n\\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\\n\\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)\\n\\tat org.eclipse.jetty.server.Server.handle(Server.java:499)\\n\\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:310)\\n\\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:257)\\n\\tat org.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:540)\\n\\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)\\n\\tat org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)\\n\\tat java.lang.Thread.run(Thread.java:745)\\nCaused by: org.apache.atlas.typesystem.types.ValueConversionException$NullConversionException: Null value not allowed for multiplicty Multiplicity{lower=1, upper=1, isUnique=false}\\n\\tat org.apache.atlas.typesystem.types.DataTypes$PrimitiveType.convertNull(DataTypes.java:93)\\n\\tat org.apache.atlas.typesystem.types.DataTypes$StringType.convert(DataTypes.java:469)\\n\\tat org.apache.atlas.typesystem.types.DataTypes$StringType.convert(DataTypes.java:452)\\n\\tat org.apache.atlas.typesystem.types.DataTypes$MapType.convert(DataTypes.java:606)\\n\\tat org.apache.atlas.typesystem.types.DataTypes$MapType.convert(DataTypes.java:562)\\n\\tat org.apache.atlas.typesystem.persistence.StructInstance.set(StructInstance.java:118)\\n\\tat org.apache.atlas.repository.graph.GraphBackedMetadataRepository$GraphToTypedInstanceMapper.mapVertexToMapInstance(GraphBackedMetadataRepository.java:1053)\\n\\tat org.apache.atlas.repository.graph.GraphBackedMetadataRepository$GraphToTypedInstanceMapper.mapVertexToAttribute(GraphBackedMetadataRepository.java:938)\\n\\tat org.apache.atlas.repository.graph.GraphBackedMetadataRepository$GraphToTypedInstanceMapper.mapVertexToInstance(GraphBackedMetadataRepository.java:907)\\n\\tat org.apache.atlas.repository.graph.GraphBackedMetadataRepository$GraphToTypedInstanceMapper.mapGraphToTypedInstance(GraphBackedMetadataRepository.java:886)\\n\\tat org.apache.atlas.repository.graph.GraphBackedMetadataRepository.getEntityDefinition(GraphBackedMetadataRepository.java:166)\\n\\t... 51 more\\n\"}))"},"dateCreated":"May 4, 2016 12:00:00 AM","dateStarted":"May 4, 2016 12:17:34 AM","dateFinished":"May 4, 2016 12:18:46 AM","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:2116"},{"text":"%hive\nCREATE TABLE IF NOT EXISTS `FactSales`(\n`SalesKey` int ,\n`DateKey` timestamp ,  \n`channelKey` int ,  \n`StoreKey` int,\n`ProductKey` int,\n`PromotionKey` int,\n`CurrencyKey` int,\n`UnitCost` float,\n`UnitPrice` float,\n`SalesQuantity` int , \n`ReturnQuantity` int,\n`ReturnAmount` float,\n`DiscountQuantity` int,\n`DiscountAmount` float,\n`TotalCost` float,\n`SalesAmount` float,\n`ETLLoadID` int,\n`LoadDate` timestamp , \n`UpdateDate` timestamp) \nSTORED AS ORC","dateUpdated":"May 4, 2016 12:17:38 AM","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Update Count","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"Update Count","index":0,"aggr":"sum"}}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000961_2034203847","id":"20160504-000000_648684445","result":{"code":"SUCCESS","type":"TABLE","msg":"Update Count\n-1\n","comment":"","msgTable":[[{"value":"-1"}]],"columnNames":[{"name":"Update Count","index":0,"aggr":"sum"}],"rows":[["-1"]]},"dateCreated":"May 4, 2016 12:00:00 AM","dateStarted":"May 4, 2016 12:17:38 AM","dateFinished":"May 4, 2016 12:18:45 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2117"},{"text":"%hive\nCREATE TABLE IF NOT EXISTS `FactOnlineSales`(\n`OnlineSalesKey` int,\n`DateKey` timestamp,\n`StoreKey` int,  \n`ProductKey` int,\n`PromotionKey` int,\n`CurrencyKey` int,\n`CustomerKey` int,\n`SalesOrderNumber` string,\n`SalesOrderLineNumber` int,\n`SalesQuantity` int , \n`SalesAmount` float,\n`ReturnQuantity` int,\n`ReturnAmount` float,\n`DiscountQuantity` int,\n`DiscountAmount` float,\n`TotalCost` float,\n`UnitCost` float,\n`UnitPrice` float,\n`ETLLoadID` int,\n`LoadDate` timestamp, \n`UpdateDate` timestamp) \nSTORED AS ORC","dateUpdated":"May 4, 2016 12:17:40 AM","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Update Count","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"Update Count","index":0,"aggr":"sum"}}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000961_2034203847","id":"20160504-000000_1812474943","result":{"code":"SUCCESS","type":"TABLE","msg":"Update Count\n-1\n","comment":"","msgTable":[[{"value":"-1"}]],"columnNames":[{"name":"Update Count","index":0,"aggr":"sum"}],"rows":[["-1"]]},"dateCreated":"May 4, 2016 12:00:00 AM","dateStarted":"May 4, 2016 12:17:41 AM","dateFinished":"May 4, 2016 12:18:45 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2118"},{"text":"%hive\nCREATE TABLE IF NOT EXISTS `DimCustomerTemp`(\n`CustomerKey` int,\n`GeographyKey` int,\n`CustomerLabel` int,\n`Title` string,\n`FirstName` string,\n`MiddleName` string,\n`LastName` string,\n`NameStyle` string,\n`BirthDate` timestamp,\n`MaritalStatus` string,\n`Suffix` string,\n`Gender` string,\n`EmailAddress` string,\n`YearlyIncome` int,\n`TotalChildren` int,\n`NumberChildrenAtHome` int,\n`Education` string,\n`Occupation` string,\n`HouseOwnerFlag` int,\n`NumberCarsOwned` int,\n`AddressLine1` string,\n`AddressLine2` string,\n`Phone` string,\n`DateFirstPurchase` timestamp,\n`CustomerType` string,\n`CompanyName` string,\n`ETLLoadID` int,\n`LoadDate` timestamp,\n`UpdateDate` timestamp)\nROW FORMAT\nDELIMITED FIELDS TERMINATED BY ',' \nLOCATION '/tmp/DimCustomer/' \ntblproperties (\"skip.header.line.count\"=\"1\")","dateUpdated":"May 4, 2016 12:17:43 AM","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Update Count","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"Update Count","index":0,"aggr":"sum"}}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000962_2035358093","id":"20160504-000000_210834306","result":{"code":"SUCCESS","type":"TABLE","msg":"Update Count\n-1\n","comment":"","msgTable":[[{"value":"-1"}]],"columnNames":[{"name":"Update Count","index":0,"aggr":"sum"}],"rows":[["-1"]]},"dateCreated":"May 4, 2016 12:00:00 AM","dateStarted":"May 4, 2016 12:17:44 AM","dateFinished":"May 4, 2016 12:18:46 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2119"},{"text":"%hive\nCREATE TABLE IF NOT EXISTS `DimCustomer`(\n`CustomerKey` int,\n`GeographyKey` int,\n`CustomerLabel` int,\n`Title` string,\n`FirstName` string,\n`MiddleName` string,\n`LastName` string,\n`NameStyle` string,\n`BirthDate` timestamp,\n`MaritalStatus` string,\n`Suffix` string,\n`Gender` string,\n`EmailAddress` string,\n`YearlyIncome` int,\n`TotalChildren` int,\n`NumberChildrenAtHome` int,\n`Education` string,\n`Occupation` string,\n`HouseOwnerFlag` int,\n`NumberCarsOwned` int,\n`AddressLine1` string,\n`AddressLine2` string,\n`Phone` string,\n`DateFirstPurchase` timestamp,\n`CustomerType` string,\n`CompanyName` string,\n`ETLLoadID` int,\n`LoadDate` timestamp,\n`UpdateDate` timestamp)\nSTORED AS ORC","dateUpdated":"May 4, 2016 12:17:46 AM","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Update Count","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"Update Count","index":0,"aggr":"sum"}}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000962_2035358093","id":"20160504-000000_144163392","result":{"code":"SUCCESS","type":"TABLE","msg":"Update Count\n-1\n","comment":"","msgTable":[[{"value":"-1"}]],"columnNames":[{"name":"Update Count","index":0,"aggr":"sum"}],"rows":[["-1"]]},"dateCreated":"May 4, 2016 12:00:00 AM","dateStarted":"May 4, 2016 12:17:47 AM","dateFinished":"May 4, 2016 12:18:46 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2120"},{"text":"%hive\nCREATE TABLE IF NOT EXISTS `DimProductTemp`(\n`ProductKey` int,\n`ProductLabel` string,\n`ProductName` string,\n`ProductDescription` string,\n`ProductSubcategoryKey` int,\n`Manufacturer` string,\n`BrandName` string,\n`ClassID` int,\n`ClassName`string,\n`StyleID` int,\n`StyleName` string,\n`ColorID` int,\n`ColorName` string,\n`Size` string,\n`SizeRange` string,\n`SizeUnitMeasureID` int,\n`Weight` float,\n`WeightUnitMeasureID` int,\n`UnitOfMeasureID` int,\n`UnitOfMeasureName` string,\n`StockTypeID` int,\n`StockTypeName` string,\n`UnitCost` int,\n`UnitPrice` float,\n`AvailableForSaleDate` timestamp,\n`StopSaleDate` timestamp,\n`Status` string,\n`ImageURL` string,\n`ProductURL` string,\n`ETLLoadID` int,\n`LoadDate` timestamp,\n`UpdateDate` timestamp)\nROW FORMAT\nDELIMITED FIELDS TERMINATED BY ',' \nLOCATION '/tmp/DimProduct/' \ntblproperties (\"skip.header.line.count\"=\"1\")","dateUpdated":"May 4, 2016 12:17:52 AM","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Update Count","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"Update Count","index":0,"aggr":"sum"}}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000962_2035358093","id":"20160504-000000_592575528","result":{"code":"ERROR","type":"TEXT","msg":"Error while processing statement: FAILED: Hive Internal Error: org.apache.atlas.AtlasServiceException(Metadata service API CREATE_ENTITY failed with status 500(Internal Server Error) Response Body ({\"error\":\"Could not process individual retrieval call \",\"stackTrace\":\"com.thinkaurelius.titan.core.TitanException: Could not process individual retrieval call \\n\\tat com.thinkaurelius.titan.graphdb.query.QueryUtil.processIntersectingRetrievals(QueryUtil.java:234)\\n\\tat com.thinkaurelius.titan.graphdb.transaction.StandardTitanTx$8.execute(StandardTitanTx.java:1234)\\n\\tat com.thinkaurelius.titan.graphdb.transaction.StandardTitanTx$8.execute(StandardTitanTx.java:1103)\\n\\tat com.thinkaurelius.titan.graphdb.query.MetricsQueryExecutor$4.apply(MetricsQueryExecutor.java:66)\\n\\tat com.thinkaurelius.titan.graphdb.query.MetricsQueryExecutor$4.apply(MetricsQueryExecutor.java:63)\\n\\tat com.thinkaurelius.titan.graphdb.query.MetricsQueryExecutor.runWithMetrics(MetricsQueryExecutor.java:81)\\n\\tat com.thinkaurelius.titan.graphdb.query.MetricsQueryExecutor.execute(MetricsQueryExecutor.java:63)\\n\\tat com.thinkaurelius.titan.graphdb.query.QueryProcessor$LimitAdjustingIterator.getNewIterator(QueryProcessor.java:195)\\n\\tat com.thinkaurelius.titan.graphdb.query.LimitAdjustingIterator.hasNext(LimitAdjustingIterator.java:54)\\n\\tat com.thinkaurelius.titan.graphdb.query.ResultSetIterator.nextInternal(ResultSetIterator.java:40)\\n\\tat com.thinkaurelius.titan.graphdb.query.ResultSetIterator.<init>(ResultSetIterator.java:30)\\n\\tat com.thinkaurelius.titan.graphdb.query.QueryProcessor.iterator(QueryProcessor.java:56)\\n\\tat com.google.common.collect.Iterables$7.iterator(Iterables.java:613)\\n\\tat com.google.common.collect.Iterables.getOnlyElement(Iterables.java:284)\\n\\tat com.thinkaurelius.titan.graphdb.database.StandardTitanGraph$1.retrieveSchemaByName(StandardTitanGraph.java:302)\\n\\tat com.thinkaurelius.titan.graphdb.database.cache.StandardSchemaCache.getSchemaId(StandardSchemaCache.java:98)\\n\\tat com.thinkaurelius.titan.graphdb.transaction.StandardTitanTx.getSchemaVertex(StandardTitanTx.java:844)\\n\\tat com.thinkaurelius.titan.graphdb.transaction.StandardTitanTx.getRelationType(StandardTitanTx.java:864)\\n\\tat com.thinkaurelius.titan.graphdb.transaction.StandardTitanTx.getOrCreatePropertyKey(StandardTitanTx.java:900)\\n\\tat com.thinkaurelius.titan.graphdb.vertices.AbstractVertex.setProperty(AbstractVertex.java:239)\\n\\tat org.apache.atlas.repository.graph.GraphBackedMetadataRepository.addProperty(GraphBackedMetadataRepository.java:867)\\n\\tat org.apache.atlas.repository.graph.GraphBackedMetadataRepository.access$900(GraphBackedMetadataRepository.java:74)\\n\\tat org.apache.atlas.repository.graph.GraphBackedMetadataRepository$TypedInstanceToGraphMapper.mapMapCollectionToVertex(GraphBackedMetadataRepository.java:733)\\n\\tat org.apache.atlas.repository.graph.GraphBackedMetadataRepository$TypedInstanceToGraphMapper.mapAttributesToVertex(GraphBackedMetadataRepository.java:668)\\n\\tat org.apache.atlas.repository.graph.GraphBackedMetadataRepository$TypedInstanceToGraphMapper.mapInstanceToVertex(GraphBackedMetadataRepository.java:637)\\n\\tat org.apache.atlas.repository.graph.GraphBackedMetadataRepository$TypedInstanceToGraphMapper.addDiscoveredInstances(GraphBackedMetadataRepository.java:611)\\n\\tat org.apache.atlas.repository.graph.GraphBackedMetadataRepository$TypedInstanceToGraphMapper.mapTypedInstanceToGraph(GraphBackedMetadataRepository.java:450)\\n\\tat org.apache.atlas.repository.graph.GraphBackedMetadataRepository$TypedInstanceToGraphMapper.access$100(GraphBackedMetadataRepository.java:436)\\n\\tat org.apache.atlas.repository.graph.GraphBackedMetadataRepository.createEntity(GraphBackedMetadataRepository.java:151)\\n\\tat org.apache.atlas.GraphTransactionInterceptor.invoke(GraphTransactionInterceptor.java:41)\\n\\tat org.apache.atlas.services.DefaultMetadataService.createEntity(DefaultMetadataService.java:232)\\n\\tat org.apache.atlas.web.resources.EntityResource.submit(EntityResource.java:96)\\n\\tat sun.reflect.GeneratedMethodAccessor38.invoke(Unknown Source)\\n\\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\n\\tat java.lang.reflect.Method.invoke(Method.java:606)\\n\\tat com.sun.jersey.spi.container.JavaMethodInvokerFactory$1.invoke(JavaMethodInvokerFactory.java:60)\\n\\tat com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$ResponseOutInvoker._dispatch(AbstractResourceMethodDispatchProvider.java:205)\\n\\tat com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:75)\\n\\tat com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:288)\\n\\tat com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:108)\\n\\tat com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)\\n\\tat com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:84)\\n\\tat com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1469)\\n\\tat com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1400)\\n\\tat com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1349)\\n\\tat com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1339)\\n\\tat com.sun.jersey.spi.container.servlet.WebComponent.service(WebComponent.java:409)\\n\\tat com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:558)\\n\\tat com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:733)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:790)\\n\\tat com.google.inject.servlet.ServletDefinition.doServiceImpl(ServletDefinition.java:287)\\n\\tat com.google.inject.servlet.ServletDefinition.doService(ServletDefinition.java:277)\\n\\tat com.google.inject.servlet.ServletDefinition.service(ServletDefinition.java:182)\\n\\tat com.google.inject.servlet.ManagedServletPipeline.service(ManagedServletPipeline.java:91)\\n\\tat com.google.inject.servlet.FilterChainInvocation.doFilter(FilterChainInvocation.java:85)\\n\\tat org.apache.atlas.web.filters.AuditFilter.doFilter(AuditFilter.java:67)\\n\\tat com.google.inject.servlet.FilterChainInvocation.doFilter(FilterChainInvocation.java:82)\\n\\tat com.google.inject.servlet.ManagedFilterPipeline.dispatch(ManagedFilterPipeline.java:119)\\n\\tat com.google.inject.servlet.GuiceFilter$1.call(GuiceFilter.java:133)\\n\\tat com.google.inject.servlet.GuiceFilter$1.call(GuiceFilter.java:130)\\n\\tat com.google.inject.servlet.GuiceFilter$Context.call(GuiceFilter.java:203)\\n\\tat com.google.inject.servlet.GuiceFilter.doFilter(GuiceFilter.java:130)\\n\\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)\\n\\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:585)\\n\\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)\\n\\tat org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:577)\\n\\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:223)\\n\\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1127)\\n\\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:515)\\n\\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)\\n\\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1061)\\n\\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\\n\\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)\\n\\tat org.eclipse.jetty.server.Server.handle(Server.java:499)\\n\\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:310)\\n\\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:257)\\n\\tat org.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:540)\\n\\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)\\n\\tat org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)\\n\\tat java.lang.Thread.run(Thread.java:745)\\nCaused by: com.thinkaurelius.titan.core.TitanException: Could not call index\\n\\tat com.thinkaurelius.titan.graphdb.transaction.StandardTitanTx$8$6.call(StandardTitanTx.java:1227)\\n\\tat com.thinkaurelius.titan.graphdb.query.QueryUtil.processIntersectingRetrievals(QueryUtil.java:232)\\n\\t... 79 more\\nCaused by: com.thinkaurelius.titan.core.TitanException: Could not execute operation due to backend exception\\n\\tat com.thinkaurelius.titan.diskstorage.util.BackendOperation.execute(BackendOperation.java:44)\\n\\tat com.thinkaurelius.titan.diskstorage.BackendTransaction.executeRead(BackendTransaction.java:428)\\n\\tat com.thinkaurelius.titan.diskstorage.BackendTransaction.indexQuery(BackendTransaction.java:380)\\n\\tat com.thinkaurelius.titan.graphdb.query.graph.MultiKeySliceQuery.execute(MultiKeySliceQuery.java:37)\\n\\tat com.thinkaurelius.titan.graphdb.database.IndexSerializer.query(IndexSerializer.java:510)\\n\\tat com.thinkaurelius.titan.graphdb.transaction.StandardTitanTx$8$6$1.call(StandardTitanTx.java:1223)\\n\\tat com.thinkaurelius.titan.graphdb.transaction.StandardTitanTx$8$6$1.call(StandardTitanTx.java:1220)\\n\\tat com.google.common.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:4792)\\n\\tat com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3599)\\n\\tat com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2379)\\n\\tat com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2342)\\n\\tat com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2257)\\n\\tat com.google.common.cache.LocalCache.get(LocalCache.java:4000)\\n\\tat com.google.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:4789)\\n\\tat com.thinkaurelius.titan.graphdb.transaction.StandardTitanTx$8$6.call(StandardTitanTx.java:1220)\\n\\t... 80 more\\nCaused by: com.thinkaurelius.titan.diskstorage.PermanentBackendException: Permanent failure in storage backend\\n\\tat com.thinkaurelius.titan.diskstorage.berkeleyje.BerkeleyJEKeyValueStore.getSlice(BerkeleyJEKeyValueStore.java:166)\\n\\tat com.thinkaurelius.titan.diskstorage.keycolumnvalue.keyvalue.OrderedKeyValueStoreAdapter.getSlice(OrderedKeyValueStoreAdapter.java:56)\\n\\tat com.thinkaurelius.titan.diskstorage.keycolumnvalue.cache.KCVSCache.getSliceNoCache(KCVSCache.java:63)\\n\\tat com.thinkaurelius.titan.diskstorage.BackendTransaction$5.call(BackendTransaction.java:383)\\n\\tat com.thinkaurelius.titan.diskstorage.BackendTransaction$5.call(BackendTransaction.java:380)\\n\\tat com.thinkaurelius.titan.diskstorage.util.BackendOperation.executeDirect(BackendOperation.java:56)\\n\\tat com.thinkaurelius.titan.diskstorage.util.BackendOperation.execute(BackendOperation.java:42)\\n\\t... 94 more\\nCaused by: com.sleepycat.je.LockTimeoutException: (JE 5.0.73) Lock expired. Locker 941997112 13388_qtp1811636174-67 - 48240de9-a356-44ae-a4d2-f4a1e3fd4cca_Txn: waited for lock on database=graphindex LockAddr:1223495868 LSN=0x0\\/0xaedb1 type=READ grant=WAIT_NEW timeoutMillis=500 startTime=1462321125521 endTime=1462321126021\\nOwners: [<LockInfo locker=\\\"715513176 13335_qtp1811636174-64 - 83550e2c-8a15-480b-95dd-8d3dfd65806e_Txn\\\" type=\\\"WRITE\\\"\\/>]\\nWaiters: [<LockInfo locker=\\\"277231471 13389_qtp1811636174-66 - f3a2d43a-1f6a-4130-831f-8c34ffc38f32_Txn\\\" type=\\\"READ\\\"\\/>, <LockInfo locker=\\\"752333817 13390_qtp1811636174-68 - 1ad3d626-2759-458f-ac10-69ae123a296a_Txn\\\" type=\\\"READ\\\"\\/>]\\n\\n\\tat com.sleepycat.je.txn.LockManager.newLockTimeoutException(LockManager.java:664)\\n\\tat com.sleepycat.je.txn.LockManager.makeTimeoutMsgInternal(LockManager.java:623)\\n\\tat com.sleepycat.je.txn.SyncedLockManager.makeTimeoutMsg(SyncedLockManager.java:97)\\n\\tat com.sleepycat.je.txn.LockManager.lockInternal(LockManager.java:390)\\n\\tat com.sleepycat.je.txn.LockManager.lock(LockManager.java:276)\\n\\tat com.sleepycat.je.txn.Txn.lockInternal(Txn.java:498)\\n\\tat com.sleepycat.je.txn.Locker.lock(Locker.java:443)\\n\\tat com.sleepycat.je.dbi.CursorImpl.lockLN(CursorImpl.java:2621)\\n\\tat com.sleepycat.je.dbi.CursorImpl.lockLN(CursorImpl.java:2422)\\n\\tat com.sleepycat.je.dbi.CursorImpl.fetchCurrent(CursorImpl.java:2253)\\n\\tat com.sleepycat.je.dbi.CursorImpl.getCurrentAlreadyLatched(CursorImpl.java:1466)\\n\\tat com.sleepycat.je.dbi.CursorImpl.getNext(CursorImpl.java:1593)\\n\\tat com.sleepycat.je.Cursor.searchInternal(Cursor.java:2742)\\n\\tat com.sleepycat.je.Cursor.searchAllowPhantoms(Cursor.java:2576)\\n\\tat com.sleepycat.je.Cursor.searchNoDups(Cursor.java:2430)\\n\\tat com.sleepycat.je.Cursor.search(Cursor.java:2397)\\n\\tat com.sleepycat.je.Cursor.getSearchKeyRange(Cursor.java:1727)\\n\\tat com.thinkaurelius.titan.diskstorage.berkeleyje.BerkeleyJEKeyValueStore.getSlice(BerkeleyJEKeyValueStore.java:123)\\n\\t... 100 more\\n\"}))"},"dateCreated":"May 4, 2016 12:00:00 AM","dateStarted":"May 4, 2016 12:17:57 AM","dateFinished":"May 4, 2016 12:18:46 AM","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:2121"},{"text":"%hive\nCREATE TABLE IF NOT EXISTS `DimProduct`(\n`ProductKey` int,\n`ProductLabel` string,\n`ProductName` string,\n`ProductDescription` string,\n`ProductSubcategoryKey` int,\n`Manufacturer` string,\n`BrandName` string,\n`ClassID` int,\n`ClassName`string,\n`StyleID` int,\n`StyleName` string,\n`ColorID` int,\n`ColorName` string,\n`Size` string,\n`SizeRange` string,\n`SizeUnitMeasureID` int,\n`Weight` float,\n`WeightUnitMeasureID` int,\n`UnitOfMeasureID` int,\n`UnitOfMeasureName` string,\n`StockTypeID` int,\n`StockTypeName` string,\n`UnitCost` int,\n`UnitPrice` float,\n`AvailableForSaleDate` timestamp,\n`StopSaleDate` timestamp,\n`Status` string,\n`ImageURL` string,\n`ProductURL` string,\n`ETLLoadID` int,\n`LoadDate` timestamp,\n`UpdateDate` timestamp)\nSTORED AS ORC","dateUpdated":"May 4, 2016 12:17:57 AM","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Update Count","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"Update Count","index":0,"aggr":"sum"}}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000967_2033434349","id":"20160504-000000_1535227957","result":{"code":"SUCCESS","type":"TABLE","msg":"Update Count\n-1\n","comment":"","msgTable":[[{"value":"-1"}]],"columnNames":[{"name":"Update Count","index":0,"aggr":"sum"}],"rows":[["-1"]]},"dateCreated":"May 4, 2016 12:00:00 AM","dateStarted":"May 4, 2016 12:18:01 AM","dateFinished":"May 4, 2016 12:18:47 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2122"},{"text":"%hive\nINSERT INTO FactSales SELECT * from FactSalesTemp","dateUpdated":"May 4, 2016 12:42:20 AM","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Update Count","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"Update Count","index":0,"aggr":"sum"}}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000968_2031510604","id":"20160504-000000_560254594","result":{"code":"ERROR","type":"TEXT","msg":"Error while processing statement: FAILED: Hive Internal Error: org.codehaus.jettison.json.JSONException(JSONArray[0] is not a JSONObject.)"},"dateCreated":"May 4, 2016 12:00:00 AM","dateStarted":"May 4, 2016 12:42:20 AM","dateFinished":"May 4, 2016 12:45:01 AM","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:2123"},{"text":"%hive\nINSERT INTO FactOnlineSales SELECT * from FactOnlineSalesTemp","dateUpdated":"May 4, 2016 12:42:25 AM","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Update Count","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"Update Count","index":0,"aggr":"sum"}}},"editorHide":false,"colWidth":12,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000968_2031510604","id":"20160504-000000_1630652910","result":{"code":"ERROR","type":"TEXT","msg":"Error while processing statement: FAILED: Hive Internal Error: org.codehaus.jettison.json.JSONException(JSONArray[0] is not a JSONObject.)"},"dateCreated":"May 4, 2016 12:00:00 AM","dateStarted":"May 4, 2016 12:42:25 AM","dateFinished":"May 4, 2016 12:52:28 AM","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:2124"},{"text":"%hive\nINSERT INTO DimCustomer SELECT * from DimCustomerTemp","dateUpdated":"May 4, 2016 12:42:27 AM","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Update Count","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"Update Count","index":0,"aggr":"sum"}}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000969_2031125855","id":"20160504-000000_197155356","result":{"code":"SUCCESS","type":"TABLE","msg":"Update Count\n-1\n","comment":"","msgTable":[[{"value":"-1"}]],"columnNames":[{"name":"Update Count","index":0,"aggr":"sum"}],"rows":[["-1"]]},"dateCreated":"May 4, 2016 12:00:00 AM","dateStarted":"May 4, 2016 12:42:27 AM","dateFinished":"May 4, 2016 12:43:53 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2125"},{"text":"%hive\nINSERT INTO DimProduct SELECT * from DimProductTemp","dateUpdated":"May 4, 2016 12:42:29 AM","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Update Count","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"Update Count","index":0,"aggr":"sum"}}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000969_2031125855","id":"20160504-000000_22800971","result":{"code":"SUCCESS","type":"TABLE","msg":"Update Count\n-1\n","comment":"","msgTable":[[{"value":"-1"}]],"columnNames":[{"name":"Update Count","index":0,"aggr":"sum"}],"rows":[["-1"]]},"dateCreated":"May 4, 2016 12:00:00 AM","dateStarted":"May 4, 2016 12:42:29 AM","dateFinished":"May 4, 2016 12:43:56 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2126"},{"title":"Federate and Expose Data with SparkSQL","text":"import org.apache.spark.sql._\nimport org.apache.spark.sql.hive.thriftserver._\nimport org.apache.spark.sql.hive.HiveContext\nimport org.apache.spark.sql.types.{StructType,StructField,StringType,IntegerType,LongType,FloatType,TimestampType};\n\nval hiveContext = new HiveContext(sc)\n\nval productDF = hiveContext.read.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").option(\"inferSchema\", \"true\").load(\"/tmp/DimProduct/DimProduct.csv\")\nproductDF.registerTempTable(\"DimProductDF\")\nproductDF.show()\n\n/*\nval hiveTablesDF = hiveContext.read.format(\"jdbc\").options(Map(\"driver\" -> \"com.mysql.jdbc.Driver\",\"url\" -> \"jdbc:mysql://sandbox.hortonworks.com/hive?user=hive&password=hive\",\"dbtable\" -> \"TBLS\")).load()\nhiveTablesDF.registerTempTable(\"tables\")\nhiveTablesDF.show()\n*/\n\nval hiveTablesDF = hiveContext.read.format(\"jdbc\").options(Map(\"driver\" -> \"org.postgresql.Driver\",\"url\" -> \"jdbc:postgresql://localhost/contoso?user=zeppelin&password=zeppelin\",\"dbtable\" -> \"dimstore\")).load()\nhiveTablesDF.registerTempTable(\"DimStoreDF\")\nhiveTablesDF.show()\n\n//hiveContext.setConf(\"spark.sql.hive.thriftServer.singleSession\",\"true\")\nhiveContext.setConf(\"spark.sql.autoBroadcastJoinThreshold\",\"100000000\")\nhiveContext.setConf(\"hive.server2.thrift.port\",\"10002\");\nHiveThriftServer2.startWithContext(hiveContext)","dateUpdated":"May 4, 2016 12:00:00 AM","config":{"enabled":true,"title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000969_2031125855","id":"20160504-000000_963830431","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark.sql._\nimport org.apache.spark.sql.hive.thriftserver._\nimport org.apache.spark.sql.hive.HiveContext\nimport org.apache.spark.sql.types.{StructType, StructField, StringType, IntegerType, LongType, FloatType, TimestampType}\nhiveContext: org.apache.spark.sql.hive.HiveContext = org.apache.spark.sql.hive.HiveContext@386ff3c2\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(name,StringType,true), StructField(age,IntegerType,true), StructField(tableKey,IntegerType,true), StructField(salesKey,IntegerType,true))\ndata: Array[String] = Array(Michael, 29, 1, 2, Andy, 30, 6, 8, Justin, 19, 12, 16)\npersonRDD: org.apache.spark.rdd.RDD[String] = ParallelCollectionRDD[7] at parallelize at <console>:47\npersonRows: org.apache.spark.rdd.RDD[org.apache.spark.sql.Row] = MapPartitionsRDD[9] at map at <console>:49\npeopleDF: org.apache.spark.sql.DataFrame = [name: string, age: int, tableKey: int, salesKey: int]\n+-------+---+--------+--------+\n|   name|age|tableKey|salesKey|\n+-------+---+--------+--------+\n|Michael| 29|       1|       2|\n|   Andy| 30|       6|       8|\n| Justin| 19|      12|      16|\n+-------+---+--------+--------+\n\nproductDF: org.apache.spark.sql.DataFrame = [ProductKey: int, ProductLabel: int, ProductName: string, ProductDescription: string, ProductSubcategoryKey: string, Manufacturer: string, BrandName: string, ClassID: string, ClassName: string, StyleID: string, StyleName: string, ColorID: string, ColorName: string, Size: string, SizeRange: string, SizeUnitMeasureID: string, Weight: string, WeightUnitMeasureID: string, UnitOfMeasureID: string, UnitOfMeasureName: string, StockTypeID: string, StockTypeName: string, UnitCost: string, UnitPrice: string, AvailableForSaleDate: string, StopSaleDate: string, Status: string, ImageURL: string, ProductURL: string, ETLLoadID: string, LoadDate: string, UpdateDate: string]\n+----------+------------+--------------------+--------------------+---------------------+------------------+--------------+----------------+-------------+-------+---------+---------------+---------+--------------+----------------+-----------------+----------------+-------------------+---------------+------------------+------------------+------------------+---------------+---------+--------------------+-------------------+------+-------------------+-------------------+-------------------+--------+-------------------+\n|ProductKey|ProductLabel|         ProductName|  ProductDescription|ProductSubcategoryKey|      Manufacturer|     BrandName|         ClassID|    ClassName|StyleID|StyleName|        ColorID|ColorName|          Size|       SizeRange|SizeUnitMeasureID|          Weight|WeightUnitMeasureID|UnitOfMeasureID| UnitOfMeasureName|       StockTypeID|     StockTypeName|       UnitCost|UnitPrice|AvailableForSaleDate|       StopSaleDate|Status|           ImageURL|         ProductURL|          ETLLoadID|LoadDate|         UpdateDate|\n+----------+------------+--------------------+--------------------+---------------------+------------------+--------------+----------------+-------------+-------+---------+---------------+---------+--------------+----------------+-----------------+----------------+-------------------+---------------+------------------+------------------+------------------+---------------+---------+--------------------+-------------------+------+-------------------+-------------------+-------------------+--------+-------------------+\n|         1|      101001|Contoso 512MB MP3...|512MB USB driver ...|                    1|           Contoso|           Ltd|         Contoso|            1|Economy|        1| Product0101001|        7|        Silver|  2.2 x 1.8 x 4 |                 |                | 4.7999999999999998|         ounces|                 1|            inches|                 1|           High|     6.62|               12.99|2005-05-03 00:00:00|      |                 On|                   |                   |       1|2008-05-25 08:01:12|\n|         2|      101002|Contoso 512MB MP3...|512MB USB driver ...|                    1|           Contoso|           Ltd|         Contoso|            1|Economy|        5| Product0101002|        3|          Blue|  2.2 x 1.8 x 4 |                 |                | 4.0999999999999996|         ounces|                 1|            inches|                 1|           High|     6.62|               12.99|2005-05-03 00:00:00|      |                 On|                   |                   |       1|2008-05-26 08:01:12|\n|         3|      101003|Contoso 1G MP3 Pl...|1GB flash memory ...|                    1|           Contoso|           Ltd|         Contoso|            1|Economy|        1| Product0101003|        8|         White|2.2  x 2.2  x 4 |                 |                |                4.5|         ounces|                 1|            inches|                 2|            Mid|      7.4|               14.52|2006-05-13 00:00:00|      |                 On|                   |                   |       1|2008-05-27 08:01:12|\n|         4|      101004|Contoso 2G MP3 Pl...|    2GB flash memory|          LCD display| plays MP3 and WMA|             1|         Contoso|          Ltd|Contoso|        1|        Economy|        1|Product0101004|               7|           Silver|2.2  x 2.2  x 4 |                   |               |               4.5|            ounces|                 1|         inches|        2|                 Mid|                 11| 21.57|2006-12-16 00:00:00|                   |                 On|        |                   |\n|         5|      101005|Contoso 2G MP3 Pl...|    2GB flash memory|          LCD display| plays MP3 and WMA|             1|         Contoso|          Ltd|Contoso|        1|        Economy|        1|Product0101005|               6|              Red| 3.7 x 0.6 x 2.2|                   |               |2.3999999999999999|            ounces|                 1|         inches|        2|                 Mid|                 11| 21.57|2006-12-17 00:00:00|                   |                 On|        |                   |\n|         6|      101006|Contoso 2G MP3 Pl...|    2GB flash memory|          LCD display| plays MP3 and WMA|             1|         Contoso|          Ltd|Contoso|        1|        Economy|        2|Product0101006|               2|            Black| 1.6 x 0.4 x 3.7|                   |               |8.8000000000000007|            ounces|                 1|         inches|        2|                 Mid|                 11| 21.57|2006-12-18 00:00:00|                   |                 On|        |                   |\n|         7|      101007|Contoso 2G MP3 Pl...|    2GB flash memory|          LCD display| plays MP3 and WMA|             1|         Contoso|          Ltd|Contoso|        1|        Economy|        1|Product0101007|               3|             Blue|2.2 x 1.5 x 0.6 |                   |               |2.1000000000000001|            ounces|                 1|         inches|        2|                 Mid|                 11| 21.57|2006-12-19 00:00:00|                   |                 On|        |                   |\n|         8|      101008|Contoso 4G MP3 Pl...|4GB flash memory ...|  LCD Display with...| plays MP3 and WMA|             1|         Contoso|          Ltd|Contoso|        1|        Economy|        2|Product0101008|               7|           Silver| 0.8 x 3.6 x 1.1|                   |               |5.5999999999999996|            ounces|                 1|         inches|        2|                 Mid|              30.58| 59.99|2007-04-16 00:00:00|                   |                 On|        |                   |\n|         9|      101009|Contoso 4G MP3 Pl...|4GB flash memory ...|  LCD Display with...| plays MP3 and WMA|             1|         Contoso|          Ltd|Contoso|        1|        Economy|        1|Product0101009|               2|            Black| 3.1 x 1.9 x 0.3|                   |               |2.1000000000000001|            ounces|                 1|         inches|        2|                 Mid|              30.58| 59.99|2007-04-16 00:00:00|                   |                 On|        |                   |\n|        10|      101010|Contoso 4G MP3 Pl...|4GB flash memory ...|  LCD Display with...| plays MP3 and WMA|             1|         Contoso|          Ltd|Contoso|        1|        Economy|        1|Product0101010|              14|            Green|   2.3 x 0.3 x 4|                   |               |                11|            ounces|                 1|         inches|        2|                 Mid|              30.58| 59.99|2007-04-16 00:00:00|                   |                 On|        |                   |\n|        11|      101011|Contoso 4G MP3 Pl...|4GB flash memory ...|  LCD Display with...| plays MP3 and WMA|             1|         Contoso|          Ltd|Contoso|        1|        Economy|        1|Product0101011|               9|           Orange| 2.2 x 0.6 x 1.4|                   |               |              14.1|            ounces|                 1|         inches|        2|                 Mid|              30.58| 59.99|2007-04-16 00:00:00|                   |                 On|        |                   |\n|        12|      101012|Contoso 4GB Flash...|     1.8'' color LCD|             play MP3| WMA and Video MTV| and share JPG|               1|      Contoso|    Ltd|  Contoso|              1|  Economy|             3|  Product0101012|                3|            Blue|    0.8 x 3.6 x 1.1|               |                  |7.4000000000000004|            ounces|              1|   inches|                   2|                Mid| 35.72|              77.68|2007-06-16 00:00:00|                   |      On|                   |\n|        13|      101013|Contoso 4GB Flash...|     1.8'' color LCD|             play MP3| WMA and Video MTV| and share JPG|               1|      Contoso|    Ltd|  Contoso|              1|  Economy|             4|  Product0101013|                2|           Black|    1.7 x 3.5 x 0.5|               |                  |2.6000000000000001|            ounces|              1|   inches|                   2|                Mid| 35.72|              77.68|2007-06-16 00:00:00|                   |      On|                   |\n|        14|      101014|Contoso 4GB Flash...|     1.8'' color LCD|             play MP3| WMA and Video MTV| and share JPG|               1|      Contoso|    Ltd|  Contoso|              1|  Economy|             1|  Product0101014|                7|          Silver|    0.4 x 1.6 x 3.6|               |                  |                 8|            ounces|              1|   inches|                   2|                Mid| 35.72|              77.68|2007-06-16 00:00:00|                   |      On|                   |\n|        15|      101015|Contoso 4GB Flash...|     1.8'' color LCD|             play MP3| WMA and Video MTV| and share JPG|               1|      Contoso|    Ltd|  Contoso|              1|  Economy|             4|  Product0101015|                8|           White|  3.26 x 2.16 x .44|               |                  |2.1000000000000001|            ounces|              1|   inches|                   2|                Mid| 35.72|              77.68|2007-06-16 00:00:00|                   |      On|                   |\n|        16|      101016|Contoso 8GB Super...|        2\" color LCD|             Touchpad|       Plays music|         video| photos and text|            1|Contoso|      Ltd|        Contoso|        2|       Regular|               3|   Product0101016|               8|              White|3.8 x 0.6 x 2.2|                  |                  |                11|         ounces|        1|              inches|                  2|   Mid|              50.56|             109.95|2008-01-16 00:00:00|        |                 On|\n|        17|      101017|Contoso 8GB Super...|        2\" color LCD|             Touchpad|       Plays music|         video| photos and text|            1|Contoso|      Ltd|        Contoso|        2|       Regular|               1|   Product0101017|               6|                Red|3.8 x 0.6 x 2.2|                  |                  |                11|         ounces|        1|              inches|                  2|   Mid|              50.56|             109.95|2008-01-16 00:00:00|        |                 On|\n|        18|      101018|Contoso 8GB Super...|        2\" color LCD|             Touchpad|       Plays music|         video| photos and text|            1|Contoso|      Ltd|        Contoso|        2|       Regular|               3|   Product0101018|              14|              Green|3.1 x 1.9 x 0.3|                  |                  |2.1000000000000001|         ounces|        1|              inches|                  2|   Mid|              50.56|             109.95|2008-01-16 00:00:00|        |                 On|\n|        19|      101019|Contoso 8GB Super...|        2\" color LCD|             Touchpad|       Plays music|         video| photos and text|            1|Contoso|      Ltd|        Contoso|        2|       Regular|               1|   Product0101019|              10|               Pink|    1.4 x 5 x 7|                  |                  |5.9000000000000004|         ounces|        1|              inches|                  2|   Mid|              50.56|             109.95|2008-01-16 00:00:00|        |                 On|\n|        20|      101020|Contoso 8GB MP3 P...|2'' LCD with blue...|        320x240-pixel|       plays music|         video| photos and text| display JPEG|    BMP|      GIF| TIFF and PNG  |        1|       Contoso|             Ltd|          Contoso|               2|            Regular|              4|    Product0101020|                 2|             Black|5.5 x 1.7 x 5.3|         |                    |                  1|pounds|                  1|             inches|                  2|     Mid|              61.62|\n+----------+------------+--------------------+--------------------+---------------------+------------------+--------------+----------------+-------------+-------+---------+---------------+---------+--------------+----------------+-----------------+----------------+-------------------+---------------+------------------+------------------+------------------+---------------+---------+--------------------+-------------------+------+-------------------+-------------------+-------------------+--------+-------------------+\nonly showing top 20 rows\n\nhiveTablesDF: org.apache.spark.sql.DataFrame = [storekey: int, geographykey: int, storemanager: int, storetype: string, storename: string, storedescription: string, status: string, opendate: timestamp, closedate: timestamp, entitykey: int, zipcode: string, zipcodeextension: string, storephone: string, storefax: string, closereason: string, employeecount: int, sellingareasize: double, lastremodeldate: timestamp, etlloadid: int, somedate1: timestamp, somedate2: timestamp, loaddate: timestamp, updatedate: timestamp]\n+--------+------------+------------+---------+--------------------+--------------------+------+--------------------+--------------------+---------+-------+----------------+------------+------------+-----------+-------------+---------------+--------------------+---------+--------------------+--------------------+--------------------+--------------------+\n|storekey|geographykey|storemanager|storetype|           storename|    storedescription|status|            opendate|           closedate|entitykey|zipcode|zipcodeextension|  storephone|    storefax|closereason|employeecount|sellingareasize|     lastremodeldate|etlloadid|           somedate1|           somedate2|            loaddate|          updatedate|\n+--------+------------+------------+---------+--------------------+--------------------+------+--------------------+--------------------+---------+-------+----------------+------------+------------+-----------+-------------+---------------+--------------------+---------+--------------------+--------------------+--------------------+--------------------+\n|       1|         693|          35|    Store|Contoso Seattle N...|Contoso Seattle N...|    On|2004-04-12 00:00:...|                null|      635|  97001|           97001|320-555-0195|320-555-0195|       null|           17|          462.0|2009-06-16 00:00:...|        1|2009-06-05 00:00:...|2009-06-05 00:00:...|2009-06-05 00:00:...|2009-06-05 00:00:...|\n|       2|         693|          35|    Store|Contoso Seattle N...|Contoso Seattle N...|    On|2004-02-14 00:00:...|                null|      636|  97001|           97002|150-555-0189|150-555-0189|       null|           25|          700.0|2009-06-17 00:00:...|        1|2009-06-05 00:00:...|2009-06-05 00:00:...|2009-06-05 00:00:...|2009-06-05 00:00:...|\n|       3|         856|          36|    Store|Contoso Kennewick...|Contoso Kennewick...|    On|2004-02-12 00:00:...|                null|      934|  97001|           97003|212-555-0187|212-555-0187|       null|           26|          680.0|2009-06-18 00:00:...|        1|2008-11-21 00:00:...|2008-11-21 00:00:...|2008-11-21 00:00:...|2008-11-21 00:00:...|\n|       4|         424|          37|    Store|Contoso Bellevue ...|Contoso Bellevue ...|    On|2004-03-01 00:00:...|                null|      638|  97001|           97004|612-555-0100|612-555-0100|       null|           19|          455.0|2009-06-16 00:00:...|        1|2009-07-01 00:00:...|2009-07-01 00:00:...|2009-07-01 00:00:...|2009-07-01 00:00:...|\n|       5|         677|          38|    Store|Contoso Redmond S...|Contoso Redmond S...|    On|2004-04-02 00:00:...|                null|      639|  97001|           97005|612-555-0100|612-555-0100|       null|           33|          560.0|2009-06-17 00:00:...|        1|2009-06-13 00:00:...|2009-06-13 00:00:...|2009-06-13 00:00:...|2009-06-13 00:00:...|\n|       6|         575|          39|    Store|Contoso Yakima Store|Contoso Yakima Store|    On|2005-05-15 00:00:...|                null|      640|  97001|           97006|168-555-0183|168-555-0183|       null|           47|         1125.0|2009-06-16 00:00:...|        1|2009-07-01 00:00:...|2009-07-01 00:00:...|2009-07-01 00:00:...|2009-07-01 00:00:...|\n|       7|         838|          40|    Store|Contoso Granger S...|Contoso Granger S...|    On|2004-06-16 00:00:...|                null|      641|  97001|           97007|913-555-0172|913-555-0172|       null|           22|          500.0|2009-06-17 00:00:...|        1|2009-02-11 00:00:...|2009-01-03 00:00:...|2009-02-11 00:00:...|2009-01-03 00:00:...|\n|       8|         935|          41|    Store|Contoso Sunnyside...|Contoso Sunnyside...|    On|2004-07-02 00:00:...|                null|      642|  97001|           97008|913-555-0172|913-555-0172|       null|           17|          460.0|2009-06-18 00:00:...|        1|2009-02-11 00:00:...|2009-06-13 00:00:...|2009-02-11 00:00:...|2009-06-13 00:00:...|\n|       9|         941|          42|    Store|Contoso Toppenish...|Contoso Toppenish...|    On|2004-08-18 00:00:...|                null|      643|  97001|           97009|903-555-0145|903-555-0145|       null|           25|          700.0|2009-06-16 00:00:...|        1|2009-02-11 00:00:...|2009-06-25 00:00:...|2009-02-11 00:00:...|2009-06-25 00:00:...|\n|      10|         947|          43|    Store|Contoso Wapato Store|Contoso Wapato Store|    On|2004-09-19 00:00:...|                null|      644|  97001|           97010|145-555-0130|145-555-0130|       null|           25|          700.0|2009-06-17 00:00:...|        1|2009-02-11 00:00:...|2009-06-05 00:00:...|2009-02-11 00:00:...|2009-06-05 00:00:...|\n|      11|         813|          44|    Store|Contoso Cle Elum ...|Contoso Cle Elum ...|    On|2004-10-20 00:00:...|                null|      645|  97001|           97011|849-555-0139|849-555-0139|       null|           26|          680.0|2009-06-16 00:00:...|        1|2009-02-11 00:00:...|2009-07-01 00:00:...|2009-02-11 00:00:...|2009-07-01 00:00:...|\n|      12|         893|          45|    Store|Contoso North Ben...|Contoso North Ben...|   Off|2004-11-21 00:00:...|2009-04-12 00:00:...|      646|  97001|           97012|206-555-0180|206-555-0180| Relocation|           19|          455.0|2009-06-17 00:00:...|        1|2009-05-25 00:00:...|2009-05-25 00:00:...|2009-05-25 00:00:...|2009-05-25 00:00:...|\n|      13|         930|          46|    Store|Contoso Snoqualmi...|Contoso Snoqualmi...|    On|2004-12-22 00:00:...|                null|      647|  97001|           97013|122-555-0189|122-555-0189|       null|           33|          560.0|2009-06-18 00:00:...|        1|2009-05-25 00:00:...|2009-05-25 00:00:...|2009-05-25 00:00:...|2009-05-25 00:00:...|\n|      14|         825|          47|    Store|Contoso Fall City...|Contoso Fall City...|    On|2006-01-23 00:00:...|                null|      648|  97001|           97014|819-555-0175|819-555-0175|       null|           47|         1125.0|2009-06-16 00:00:...|        1|2009-07-10 00:00:...|2009-06-16 00:00:...|2009-07-10 00:00:...|2009-06-16 00:00:...|\n|      15|         678|          48|    Store|Contoso Renton Store|Contoso Renton Store|    On|2004-02-24 00:00:...|                null|      649|  97001|           97015|424-555-0189|424-555-0189|       null|           22|          500.0|2009-06-17 00:00:...|        1|2009-07-10 00:00:...|2009-06-17 00:00:...|2009-07-10 00:00:...|2009-06-17 00:00:...|\n|      16|         627|          49|    Store|Contoso Everett S...|Contoso Everett S...|    On|2004-01-25 00:00:...|                null|      650|  97001|           97016|508-555-0165|508-555-0165|       null|           17|          462.0|2009-06-16 00:00:...|        1|2009-07-10 00:00:...|2009-06-16 00:00:...|2009-07-10 00:00:...|2009-06-16 00:00:...|\n|      17|         551|         135|    Store|Contoso Spokane S...|Contoso Spokane S...|    On|2004-03-26 00:00:...|                null|      651|  97001|           97017|984-555-0185|984-555-0185|       null|           25|          700.0|2009-06-17 00:00:...|        1|2009-07-10 00:00:...|2009-06-17 00:00:...|2009-07-10 00:00:...|2009-06-17 00:00:...|\n|      18|         944|          50|    Store|Contoso Veradale ...|Contoso Veradale ...|    On|2004-07-27 00:00:...|                null|      652|  97001|           97018|632-555-0129|632-555-0129|       null|           26|          680.0|2009-06-18 00:00:...|        1|2009-07-10 00:00:...|2009-06-18 00:00:...|2009-07-10 00:00:...|2009-06-18 00:00:...|\n|      19|         812|          51|    Store|Contoso Cheney Store|Contoso Cheney Store|   Off|2004-08-28 00:00:...|2009-05-12 00:00:...|      653|  97001|           97019|328-555-0150|328-555-0150|      Store|           19|          455.0|2009-06-16 00:00:...|        1|2009-07-10 00:00:...|2009-06-16 00:00:...|2009-07-10 00:00:...|2009-06-16 00:00:...|\n|      20|         824|          52|    Store|Contoso Englewood...|Contoso Englewood...|    On|2004-09-29 00:00:...|                null|      654|  87001|           87001|435-555-0113|435-555-0113|       null|           33|          560.0|2009-06-17 00:00:...|        1|2009-07-10 00:00:...|2009-06-17 00:00:...|2009-07-10 00:00:...|2009-06-17 00:00:...|\n+--------+------------+------------+---------+--------------------+--------------------+------+--------------------+--------------------+---------+-------+----------------+------------+------------+-----------+-------------+---------------+--------------------+---------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"},"dateCreated":"May 4, 2016 12:00:00 AM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2127"},{"title":"Cache Data in SparkSQL for Performance Boost","text":"hiveContext.cacheTable(\"factsales\")\nhiveContext.cacheTable(\"factonlinesales\")\nhiveContext.cacheTable(\"dimstoredf\")\nhiveContext.cacheTable(\"dimproductdf\")","dateUpdated":"May 4, 2016 2:46:23 AM","config":{"enabled":true,"title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000970_2032280102","id":"20160504-000000_628904496","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"May 4, 2016 12:00:00 AM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2128"},{"text":"","dateUpdated":"May 4, 2016 2:47:46 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462320000970_2032280102","id":"20160504-000000_83353738","dateCreated":"May 4, 2016 12:00:00 AM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2129"}],"name":"SparkSQLFederatedSetup","id":"2BJYT4AJ9","angularObjects":{"2BCKC8XEM":[],"2BCX68DXU":[],"2BFBT15Z1":[],"2BESYJRTZ":[],"2BCBP9D5X":[],"2BDTPNC5U":[],"2BF9DMDST":[],"2BEA4YGRP":[],"2BEP4GTHY":[],"2BD3W8Y9X":[],"2BEJY9WFY":[],"2BCSDJUE3":[],"2BEPFKEXV":[]},"config":{"looknfeel":"default"},"info":{}}